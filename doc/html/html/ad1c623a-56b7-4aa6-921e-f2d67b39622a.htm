<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Creating the Navigation Mesh</title><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><link rel="stylesheet" type="text/css" href="ms-help://Dx/DxRuntime/DxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/LanguageFilter.js"> </script><script type="text/javascript" src="../scripts/DataStore.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><script type="text/javascript" src="../scripts/MemberFilter.js"> </script><xml><MSHelp:TOCTitle Title="" /><MSHelp:Keyword Index="A" Term="ad1c623a-56b7-4aa6-921e-f2d67b39622a" /><MSHelp:Attr Name="RevisionNumber" Value="1" /><MSHelp:Attr Name="AssetID" Value="ad1c623a-56b7-4aa6-921e-f2d67b39622a" /><MSHelp:Attr Name="Abstract" Value="The final step in the NMGen build process is to create the navigation mesh. As a minimum you must have T:org.critterai.nmgen.PolyMesh data. T:org.critterai.nmgen.PolyMeshDetail and T:org.critterai.nmbuild.ConnectionSet data are optional." /><MSHelp:Attr Name="TopicType" Value="kbArticle" /><MSHelp:Attr Name="Locale" Value="en-us" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collall.gif" alt="CollapseAll image" title="CollapseAll image" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expall.gif" alt="ExpandAll image" title="ExpandAll image" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected.gif" alt="DropDown image" title="DropDown image" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected_hover.gif" alt="DropDownHover image" title="DropDownHover image" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><img id="checkBoxSelectImage" style="display:none; height:0; width:0;" src="../icons/ch_selected.gif" /><img id="checkBoxUnSelectImage" style="display:none; height:0; width:0;" src="../icons/ch_unselected.gif" /><img id="checkBoxSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/ch_selected_hover.gif" /><img id="checkBoxUnSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/ch_unselected_hover.gif" /><img id="radioSelectImage" style="display:none; height:0; width:0;" src="../icons/r_select.gif" /><img id="radioUnSelectImage" style="display:none; height:0; width:0;" src="../icons/r_unselect.gif" /><img id="radioSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/r_select_hover.gif" /><img id="radioUnSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/r_unselect_hover.gif" /><img id="curvedLeftSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_lft_cnr.gif" /><img id="curvedRightSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_rt_cnr.gif" /><img id="curvedLeftUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_lft_cnr.gif" /><img id="curvedRightUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_rt_cnr.gif" /><img id="gradLeftSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_lft_grad.gif" /><img id="gradRightSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_rt_grad.gif" /><img id="gradLeftUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_lft_grad.gif" /><img id="gradRightUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_rt_grad.gif" /><img id="twirlSelectImage" style="display:none; height:0; width:0;" src="../icons/twirl_selected.gif" /><img id="twirlUnSelectImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected.gif" /><img id="twirlSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/twirl_selected_hover.gif" /><img id="twirlUnSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected_hover.gif" /><img id="NSRBottomImage" style="display:none; height:0; width:0;" src="../icons/NSRbottomgrad.gif" /><div id="header"><table id="topTable"><tr id="headerTableRow3"><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collall.gif" alt="CollapseAll image" title="CollapseAll image" /><label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span> | <span id="languageFilterToolTip" style="cursor:default;" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0"><img id="languageFilterImage" src="../icons/twirl_unselected.gif" alt="DropDown image" title="DropDown image" /><label id="CSharpLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label><label id="VisualBasicLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label><label id="ManagedCPlusPlusLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual C++</label></span><div id="languageSpan"><div id="CSharp" onclick="changeLanguage(data, 'CSharp', 'cs');"><img id="CSharpImage" onmouseover="mouseOverCheck(CSharpImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" onmouseout="mouseOutCheck(CSharpImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" src="../icons/r_unselect.gif" /> C#</div><br /><div id="VisualBasic" onclick="changeLanguage(data, 'VisualBasic', 'vb');"><img id="VisualBasicImage" onmouseover="mouseOverCheck(VisualBasicImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" onmouseout="mouseOutCheck(VisualBasicImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" src="../icons/r_unselect.gif" /> Visual Basic</div><br /><div id="ManagedCPlusPlus" onclick="changeLanguage(data, 'ManagedCPlusPlus', 'cpp');"><img id="ManagedCPlusPlusImage" onmouseover="mouseOverCheck(ManagedCPlusPlusImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" onmouseout="mouseOutCheck(ManagedCPlusPlusImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" src="../icons/r_unselect.gif" /> Visual C++</div><br /></div> | <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a></td></tr><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">CritterAI Documentation</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Creating the Navigation Mesh</span></td></tr><tr><td class="nsrBottom" background="../icons/NSRbottomgrad.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"><p style="color: #dc143c; font-size: 8.5pt; font-weight: bold;">[This is preliminary documentation and is subject to change.]</p></span><div class="introduction"><p>
			The final step in the NMGen build process is to create the navigation mesh.  As a minimum you must have <span sdata="cer" target="T:org.critterai.nmgen.PolyMesh"><a href="229D6633.htm">PolyMesh</a></span> data.
			<span sdata="cer" target="T:org.critterai.nmgen.PolyMeshDetail"><a href="287D3362.htm">PolyMeshDetail</a></span> and <span sdata="cer" target="T:org.critterai.nmbuild.ConnectionSet"><a href="5AB06572.htm">ConnectionSet</a></span> data are optional.
			</p><p>
			See the <span sdata="link"><a href="6cf1c77d-725a-4f3e-bcbf-62e7fc5e2bc6.htm">The Navigation Mesh</a></span> topic for the general creation process.  This topic will cover two
			helpful extensions.
			</p></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggleID0ECAAA)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggleID0ECAAA, event)" tabindex="0"><img id="sectionToggleID0ECAAA" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Creating Tile Data</span></h1><div id="sectionSectionID0ECAAA" class="section" name="collapseableSection" style=""><p>
				Before you can create a navigation mesh you need to convert your source data into tile data.  There are various ways of doing this.
				</p><p>
				One method is to use the 
				<span sdata="cer" target="M:org.critterai.nmbuild.NMBuild.GetBuildData(org.critterai.nmgen.BuildContext,System.Int32,System.Int32,org.critterai.nmgen.PolyMeshData,org.critterai.nmgen.PolyMeshDetailData,org.critterai.nmbuild.ConnectionSet,System.Boolean)"><a href="57DEEED8.htm">GetBuildData(BuildContext, Int32, Int32, PolyMeshData, PolyMeshDetailData, ConnectionSet, Boolean)</a></span> utility method.
				</p><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Example: Using the tile build data utility method.</span>

BuildContext logger = <span class="highlight-keyword">new</span> BuildContext();

NavmeshTileBuildData tbd = NMBuild.GetBuildData(
            tileX, tileZ    <span class="highlight-comment">// The tile location.  (0, 0) for single tile meshes.</span>
            , polyData      <span class="highlight-comment">// A PolyMeshData object.</span>
            , detailData  <span class="highlight-comment">// Optional PolyMeshDetailData object.</span>
            , connections <span class="highlight-comment">// Optional ConnectionSet object.</span>
            , logger);

<span class="highlight-keyword">if</span> (tbd == <span class="highlight-keyword">null</span>)
{
    <span class="highlight-comment">// Perform error handling.</span>
    <span class="highlight-comment">// The build context will contain error messages.</span>
}

<span class="highlight-comment">// Use the build data to create the navigation mesh...</span></pre></div></span><p>
				Another method is to use the the <span sdata="cer" target="T:org.critterai.nmbuild.TileBuildTask"><a href="8098FF23.htm">TileBuildTask</a></span> class to create the tile data.  This method
				is especially useful if you are building a multi-tile navigation mesh or performing background builds.
				</p><span id="cbc_2" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Example: Using the tile build task.</span>

TileBuildTask task = TileBuildTask.Create(
        tileX, tileZ    <span class="highlight-comment">// The tile location.  (0, 0) for single tile meshes.</span>
        , polyData      <span class="highlight-comment">// A PolyMeshData object.</span>
        , detailData  <span class="highlight-comment">// Optional PolyMeshDetailData object.</span>
        , connections <span class="highlight-comment">// Optional ConnectionSet object.</span>
        , <span class="highlight-keyword">false</span>       <span class="highlight-comment">// Is the task tread-safe?  Not applicable in this case.</span>
        , <span class="highlight-number">0</span>);                    <span class="highlight-comment">// Task priority.  Not applicable in this case.</span>

task.Run();

<span class="highlight-keyword">if</span> (task.TaskState == BuildTaskState.Aborted)
{
    <span class="highlight-comment">// Perform error handling.</span>
    <span class="highlight-comment">// Check task messages for details.</span>
}

<span class="highlight-comment">// Get the tile assets.</span>
TileBuildAssets tassets = task.Result;

<span class="highlight-comment">// Use the tile data to build the navigation mesh...</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggleID0EBAAA)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggleID0EBAAA, event)" tabindex="0"><img id="sectionToggleID0EBAAA" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Creating the Navigation Mesh</span></h1><div id="sectionSectionID0EBAAA" class="section" name="collapseableSection" style=""><p>Once you have the tile data you can use one of two methods to create the final navigation mesh.</p><span id="cbc_3" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Example: Create a single tile mesh.</span>

<span class="highlight-comment">// Where 'buildData' is a NavmeshTileBuildData object.</span>

Navmesh navmesh;
NavStatus status = Navmesh.Create(buildData, <span class="highlight-keyword">out</span> nm)));

<span class="highlight-keyword">if</span> ((status &amp; NavStatus.Success) == <span class="highlight-number">0</span>)
{
    <span class="highlight-comment">// Perform error handling.</span>
}

<span class="highlight-comment">// Use the navitgation mesh...</span></pre></div></span><p /><span id="cbc_4" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Example: Create an empty mesh, then add tiles.</span>

<span class="highlight-comment">// Where 'tiles' is a list containing NavmeshTileData objects.</span>

NavmeshParams nconfig = <span class="highlight-keyword">new</span> NavmeshParams(meshOrigin
        , tileSetWidth, tileSetDepth
        , tiles.Count
        , maxPolysPerTile);

Navmesh navmesh;

NavStatus status = Navmesh.Create(nconfig, <span class="highlight-keyword">out</span> navmesh)

<span class="highlight-keyword">if</span> ((status &amp; NavStatus.Success) == <span class="highlight-number">0</span>)
{
        <span class="highlight-comment">// Perform error handling.</span>
}

<span class="highlight-comment">// Add the tiles to the navigation mesh.</span>
<span class="highlight-keyword">foreach</span> (NavmeshTileData tile <span class="highlight-keyword">in</span> tiles)
{
        <span class="highlight-comment">// Note: Allowing the navigation mesh to assign the tile reference.</span>
        <span class="highlight-keyword">uint</span> trash;
        navmesh.AddTile(tile, Navmesh.NullTile, <span class="highlight-keyword">out</span> trash);
}

<span class="highlight-comment">// Use the navigation mesh.</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><h4 class="subHeading">Concepts</h4><div class="seeAlsoStyle"><span sdata="link"><a href="0b06b934-9f2b-43a3-a96b-6fd9dc8483c7.htm">An Introduction to NMGen</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="3D048EB4-7BD1-407a-9442-9DE60C82266E.htm">Compiling the Input</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="FCD34CAE-02FA-48fd-891E-FB82EE360F49.htm">The Incremental Builder</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="e76dda55-5f91-4c2a-bf8d-fa34de59e82b.htm">Building Multi-Tile Meshes</a></span></div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><span sdata="cer" target="T:org.critterai.nav.Navmesh"><a href="90CC41AC.htm">Navmesh</a></span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:org.critterai.nav.NavmeshParams"><a href="ADC08A72.htm">NavmeshParams</a></span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:org.critterai.nav.NavmeshTileBuildData"><a href="73B93BBC.htm">NavmeshTileBuildData</a></span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:org.critterai.nav.NavmeshTileData"><a href="809F0D0.htm">NavmeshTileData</a></span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:org.critterai.nmbuild.TileBuildTask"><a href="8098FF23.htm">TileBuildTask</a></span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:org.critterai.nmbuild.TileBuildAssets"><a href="7B29896D.htm">TileBuildAssets</a></span></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><a href="http://www.critterai.org/" target="_parent">Project Home</a> | <a href="http://code.google.com/p/critterai/" target="_parent">Source Code</a> | <a href="http://www.critterai.org/cailic" target="_parent">License</a><p />Copyright (c) 2010-2012 Stephen A. Pratt</div></div></div></body></html>