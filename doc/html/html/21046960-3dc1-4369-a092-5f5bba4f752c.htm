<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Areas and the Build</title><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><link rel="stylesheet" type="text/css" href="ms-help://Dx/DxRuntime/DxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/LanguageFilter.js"> </script><script type="text/javascript" src="../scripts/DataStore.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><script type="text/javascript" src="../scripts/MemberFilter.js"> </script><xml><MSHelp:TOCTitle Title="" /><MSHelp:Keyword Index="A" Term="21046960-3dc1-4369-a092-5f5bba4f752c" /><MSHelp:Attr Name="RevisionNumber" Value="1" /><MSHelp:Attr Name="AssetID" Value="21046960-3dc1-4369-a092-5f5bba4f752c" /><MSHelp:Attr Name="Abstract" Value="Areas in CAINav are represented by a byte value between zero and 63. In the navigation mesh they are assigned to polygons and used to assign traversal cost. For example, all polygons assigned an area of 24 may be assigned a cost of 1.5 while polygons ..." /><MSHelp:Attr Name="TopicType" Value="kbArticle" /><MSHelp:Attr Name="Locale" Value="en-us" /></xml></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collall.gif" alt="CollapseAll image" title="CollapseAll image" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expall.gif" alt="ExpandAll image" title="ExpandAll image" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected.gif" alt="DropDown image" title="DropDown image" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected_hover.gif" alt="DropDownHover image" title="DropDownHover image" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><img id="checkBoxSelectImage" style="display:none; height:0; width:0;" src="../icons/ch_selected.gif" /><img id="checkBoxUnSelectImage" style="display:none; height:0; width:0;" src="../icons/ch_unselected.gif" /><img id="checkBoxSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/ch_selected_hover.gif" /><img id="checkBoxUnSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/ch_unselected_hover.gif" /><img id="radioSelectImage" style="display:none; height:0; width:0;" src="../icons/r_select.gif" /><img id="radioUnSelectImage" style="display:none; height:0; width:0;" src="../icons/r_unselect.gif" /><img id="radioSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/r_select_hover.gif" /><img id="radioUnSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/r_unselect_hover.gif" /><img id="curvedLeftSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_lft_cnr.gif" /><img id="curvedRightSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_rt_cnr.gif" /><img id="curvedLeftUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_lft_cnr.gif" /><img id="curvedRightUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_rt_cnr.gif" /><img id="gradLeftSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_lft_grad.gif" /><img id="gradRightSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_sel_rt_grad.gif" /><img id="gradLeftUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_lft_grad.gif" /><img id="gradRightUnSelectImage" style="display:none; height:0; width:0;" src="../icons/tab_unsel_rt_grad.gif" /><img id="twirlSelectImage" style="display:none; height:0; width:0;" src="../icons/twirl_selected.gif" /><img id="twirlUnSelectImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected.gif" /><img id="twirlSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/twirl_selected_hover.gif" /><img id="twirlUnSelectHoverImage" style="display:none; height:0; width:0;" src="../icons/twirl_unselected_hover.gif" /><img id="NSRBottomImage" style="display:none; height:0; width:0;" src="../icons/NSRbottomgrad.gif" /><div id="header"><table id="topTable"><tr id="headerTableRow3"><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collall.gif" alt="CollapseAll image" title="CollapseAll image" /><label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span> | <span id="languageFilterToolTip" style="cursor:default;" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0"><img id="languageFilterImage" src="../icons/twirl_unselected.gif" alt="DropDown image" title="DropDown image" /><label id="CSharpLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label><label id="VisualBasicLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label><label id="ManagedCPlusPlusLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual C++</label></span><div id="languageSpan"><div id="CSharp" onclick="changeLanguage(data, 'CSharp', 'cs');"><img id="CSharpImage" onmouseover="mouseOverCheck(CSharpImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" onmouseout="mouseOutCheck(CSharpImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" src="../icons/r_unselect.gif" /> C#</div><br /><div id="VisualBasic" onclick="changeLanguage(data, 'VisualBasic', 'vb');"><img id="VisualBasicImage" onmouseover="mouseOverCheck(VisualBasicImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" onmouseout="mouseOutCheck(VisualBasicImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" src="../icons/r_unselect.gif" /> Visual Basic</div><br /><div id="ManagedCPlusPlus" onclick="changeLanguage(data, 'ManagedCPlusPlus', 'cpp');"><img id="ManagedCPlusPlusImage" onmouseover="mouseOverCheck(ManagedCPlusPlusImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" onmouseout="mouseOutCheck(ManagedCPlusPlusImage,radioSelectImage,radioUnSelectImage,radioSelectHoverImage,radioUnSelectHoverImage)" src="../icons/r_unselect.gif" /> Visual C++</div><br /></div> | <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a></td></tr><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">CritterAI Documentation</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Areas and the Build</span></td></tr><tr><td class="nsrBottom" background="../icons/NSRbottomgrad.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"><p style="color: #dc143c; font-size: 8.5pt; font-weight: bold;">[This is preliminary documentation and is subject to change.]</p></span><div class="introduction"><p>
			Areas in <b>CAINav</b> are represented by a byte value between zero and 63.  In the navigation mesh they are assigned to polygons
			and used to assign traversal cost.  For example, all polygons assigned an area of 24 may be assigned a cost of 1.5 while polygons
			assigned an area of 63 may be assigned a cost of 1.0.  The meaning and cost associated with each area is defined by the end user.  The only 
			exception is 0, which is always considered to mean 'unwalkable'.
			</p><p>
			Areas are also used in the NMGen build process.  But while their purpose and use in the navigation mesh is fairly straight forward,
			things can get complicated in the build process.  This topic covers various ways of using areas during the build process to get the navigation mesh you want.
			</p><p /><div class="alert"><table><tr><th><img src="../icons/alert_note.gif" title="Note" /> <b>Note:</b></th></tr><tr><td><p>
				Area constants can be found in the <span sdata="cer" target="T:org.critterai.nmgen.NMGen"><a href="4B71ADC1.htm">NMGen</a></span> and
				<span sdata="cer" target="T:org.critterai.nav.Navmesh"><a href="90CC41AC.htm">Navmesh</a></span> classes.
				</p></td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggleID0EDAAA)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggleID0EDAAA, event)" tabindex="0"><img id="sectionToggleID0EDAAA" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Why Use Areas in the Build Process</span></h1><div id="sectionSectionID0EDAAA" class="section" name="collapseableSection" style=""><p>
				If you assign everything to only a single area during the NMGen build process then polygons will form based solely 
				on the structure of the source geometry.  Polygon edges will form along the borders of obstructions, in structural portals such as doorways, etc.
				The surface type of the source geometry is unknown and can't be taken into account. So, for example, a single polygon may cover both 
				meadow and swamp surfaces, even though the cost of traversing the surfaces is different.
				</p><p>
				Essentially, areas allow you to specify surface type so that the build process can make sure that polygons are formed such that they don't
				overlap different area types.  Polygon edges will always form at the boundry between different areas.
				</p><p>
				The obvious benefit of forming polygons based on surface type is that it allows you to properly control traversal cost.  But there are other purposes.
				One example is flag assignment. Polygons have an associated 16-bit flags field.  These flags are used to filter polygons during pathfinding.  For example, you 
				can specify that all polygons with the 0x10 flag are inaccessible, so pathfinding will ignore the polygons.  Areas can be used to ensure that polygons
				form in a way that allow flags to be used properly.
				</p><p>
				Let's say you have a bridge that can partially collapse.  There is no way for the build process to know exaclty which part of the bridge can collapse,
				so you can't guarentee that separate polygons will exist at the proper location.  Unless, of course, you mark the collapse location with a different area 
				than the rest of the bridge.
				</p><p>
				In the below example, cylinder and convex areas are marked into the mesh.  The convex marker was given a higher priority so that it overwrites part 
				of the cyclinder area.
				</p><div class="mediaNear"><img alt="Overlapping Area Markers" src="../media/OverlappingAreaMarkers.jpg" /></div><p>
				As you can see, areas provide a powerful method of ensuring the final mesh structure is what you need it to be.
				</p></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggleID0ECAAA)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggleID0ECAAA, event)" tabindex="0"><img id="sectionToggleID0ECAAA" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />The Power of Zero</span></h1><div id="sectionSectionID0ECAAA" class="section" name="collapseableSection" style=""><p>
				The zero area is called the 'NullArea' and has a special meaning to the NMGen build process.  Any surface marked as NullArea
				is unwalkable and no polygons will form.  All NullArea surfaces are considered obstacles.
				</p><p>
				The build process automatically handles NullArea assignment for most cases.  The surface's slope may be too steep.  (E.g. Walls)  The
				polygons formed on the surface may be too small to be of use.  (E.g. Stairway railings or a counter top.)  The surface may be inaccessible due 
				to height restrictions. (E.g. The floor under a table.)
				</p><p>
				But sometimes you may want to manually block off an area.  For example, let's say you have a surface covered by burning rubbish.  The structure
				of the surface may be walkable, but you never want it to be walkable.  In cases such as this you can manually mark the surface as a NullArea and
				the build process will treat it as an obstacle.
				</p><p>
				The NullArea is treated differently than other areas in another way.  Normal areas can be reassigned at will.  You can assign a surface to area
				15 during one part of the build process then reassign part of it to area 22 later on.  A NullArea can never be reassigned.  Once a NullArea, always
				a NullArea.  You never have to worry about accidentally making a NullArea walkable again.
				</p></div><h1 class="heading"><span onclick="ExpandCollapse(sectionToggleID0EBAAA)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggleID0EBAAA, event)" tabindex="0"><img id="sectionToggleID0EBAAA" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />How to Assign Areas</span></h1><div id="sectionSectionID0EBAAA" class="section" name="collapseableSection" style=""><p>
				There are three points in the build process where you can assign areas:
				</p><ul><li>To the source geometry triangles when compiling the input.</li><li>To convex areas in the <span sdata="cer" target="T:org.critterai.nmgen.CompactHeightfield"><a href="C929BBDA.htm">CompactHeightfield</a></span> object.</li><li>To polygons in the <span sdata="cer" target="T:org.critterai.nmgen.PolyMesh"><a href="229D6633.htm">PolyMesh</a></span> object.</li></ul><p /><div class="alert"><table><tr><th><img src="../icons/alert_note.gif" title="Note" /> <b>Note:</b></th></tr><tr><td><p>
					Technically, you can't perform a NMGen build without assigning areas.  At some point in the build it will detect
					that you haven't assigned areas and will assign all surfaces to a default area.  
					</p></td></tr></table></div><h3 class="subHeading">Source Geometry Area Assignment</h3><div class="subsection"><p>
						The first point at which you can assign areas is during the input compile.  You can assign each source geometry triangle to an area.
						This is a great place to assign areas if your source geometry is inherently categorized by surface type.  E.g. All bridge and sidewalk
						meshes get one area while all water meshes get a different area.
						</p><p>
						Both the <span sdata="cer" target="T:org.critterai.nmbuild.InputGeometryCompiler"><a href="A95AC7F3.htm">InputGeometryCompiler</a></span> and
						<span sdata="cer" target="T:org.critterai.nmbuild.InputGeometry"><a href="AF3844AA.htm">InputGeometry</a></span> classes provide ways to assign areas to triangles.  The <a href="http://unity3d.com/" target="_blank">Unity</a> build process
						includes the ability to assign area by tag assignment or mesh.
						</p></div><h3 class="subHeading">Marking the CompactHeightfield</h3><div class="subsection"><p>
						In some cases it either isn't possible or isn't appropriate to assign areas to the source geometry.  The next option is to mark areas 
						directly into the <span sdata="cer" target="T:org.critterai.nmgen.CompactHeightfield"><a href="C929BBDA.htm">CompactHeightfield</a></span> during its post-processing step.  The 
						<span sdata="cer" target="T:org.critterai.nmbuild.AreaBoxMarker"><a href="24D7F85A.htm">AreaBoxMarker</a></span>,
					  <span sdata="cer" target="T:org.critterai.nmbuild.AreaCylinderMarker"><a href="8695C7F.htm">AreaCylinderMarker</a></span>, and 
					  <span sdata="cer" target="T:org.critterai.nmbuild.AreaConvexMarker"><a href="FD96AF46.htm">AreaConvexMarker</a></span> classes can be used to mark arbitrary convex areas
						into the heightfield.
						</p><p>
						This is the most accurate method of marking an area since marking occurs at the resolution of the heightfield.  (I.e. The cell size.)
						However, if abused it can create a lot of extra polygons.
						</p><p /><div class="alert"><table><tr><th><img src="../icons/alert_note.gif" title="Note" /> <b>Note:</b></th></tr><tr><td><p>
							The above area markers and the build process supports priority assignment, so it is possible to use overlapping markers.  The overlapped
							area will be assigned the area of the highest priority marker.
							</p></td></tr></table></div></div><h3 class="subHeading">Area Assignment in the PolyMesh</h3><div class="subsection"><p>
						Each polygon in the <span sdata="cer" target="T:org.critterai.nmgen.PolyMesh"><a href="229D6633.htm">PolyMesh</a></span> has an area assignment that is inherited from the earlier in the build process.  This is the value
						that will be assigned to the polygon once it is added to the navigation mesh.  At this point the polygons are pretty much fixed, so it isn't particularly
						useful to assign the NullArea.  But sometimes it is useful to perform some final area adjustements.  For example, if you assigned an area only
						to ensure proper polygon formation, and the area isn't needed for adjusting traversal cost in the navigation mesh, you can re-assign the area to
						a default area. (I.e. Clean things up.)
						</p></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><h4 class="subHeading">Concepts</h4><div class="seeAlsoStyle"><span sdata="link"><a href="0b06b934-9f2b-43a3-a96b-6fd9dc8483c7.htm">An Introduction to NMGen</a></span></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><a href="http://www.critterai.org/" target="_parent">Project Home</a> | <a href="http://code.google.com/p/critterai/" target="_parent">Source Code</a> | <a href="http://www.critterai.org/cailic" target="_parent">License</a><p />Copyright (c) 2010-2012 Stephen A. Pratt</div></div></div></body></html>